<!-- 0. revise 4 files -->
<!-- 1. Enter your name  , FE DONE--> 
<!-- 2. store name(Dad) DONE -->
<!-- 3. Display score , FE DONE-- -->
<!-- 4.update score in  backend 300 to 0 (count , BE) DONE---->
<!-- 5. Display clue button , move to dictionary , FE-->
<!-- clue logic: 
1. clikc button similar to others
2. onclick, call api
3. main - cll gamelogic.showclue
4.implement show clue
5. WORDS[targetword]
6. display back
BE-->
<!-- 6. if clue is asked, reduce 50 , BE-->
<!-- 7. Show leaderboard (Top 5 scores)  Dad DONE-->

<!DOCTYPE html>
<html>
<head>
  <title>Wordle Game - Abheek & Akira's Fun Zone</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background: linear-gradient(135deg, #667eea, #764ba2);
      margin: 0;
      padding: 0;
      height: 100vh;
      color: #333;
      overflow: hidden;
    }

    .main-layout {
      display: flex;
      gap: 15px;
      height: 100vh;
      padding: 15px;
      box-sizing: border-box;
    }

    .game-container {
      flex: 3;
      background: rgba(255, 255, 255, 0.95);
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      overflow-y: auto;
      max-width: calc(100vw - 350px);
    }

    .instructions-container {
      flex: 1;
      min-width: 320px;
      max-width: 350px;
      background: rgba(255, 255, 255, 0.9);
      padding: 20px;
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
      height: calc(100vh - 30px);
      overflow-y: auto;
      position: sticky;
      top: 0;
    }
    .container {
      /* Old container styles removed - now using game-container */
    }

    h1 {
      text-align: center;
      color: #4ecdc4;
      margin-bottom: 20px;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
    }

    .back-button {
      background: #ff6b6b;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 15px;
      cursor: pointer;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      font-weight: bold;
      text-decoration: none;
      display: inline-block;
      margin-bottom: 20px;
      transition: transform 0.2s;
    }

    .back-button:hover {
      transform: scale(1.05);
    }

    .game-controls {
      text-align: center;
      margin-bottom: 30px;
    }

    input[type="text"] {
      padding: 15px;
      font-size: 18px;
      border: 3px solid #4ecdc4;
      border-radius: 15px;
      margin: 10px;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      text-align: center;
      text-transform: uppercase;
    }

    button {
      background: linear-gradient(45deg, #4ecdc4, #44a08d);
      color: white;
      border: none;
      padding: 15px 25px;
      font-size: 16px;
      border-radius: 15px;
      cursor: pointer;
      margin: 5px;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      font-weight: bold;
      transition: transform 0.2s;
    }

    button:hover {
      transform: scale(1.05);
    }

    .reset-btn {
      background: linear-gradient(45deg, #ff6b6b, #ee5a52);
    }

    .clue-btn {
        background: linear-gradient(45deg, #ff7e00, #ff4500);
      }

    .letter {
      display: inline-block;
      width: 50px;
      height: 50px;
      line-height: 50px;
      text-align: center;
      margin: 3px;
      border: 3px solid #ccc;
      border-radius: 10px;
      font-weight: bold;
      font-size: 24px;
      font-family: 'Comic Sans MS', cursive, sans-serif;
    }
    .correct {
      background-color: #6aaa64;
      color: white;
      border-color: #6aaa64;
    }
    .partial {
      background-color: #c9b458;
      color: white;
      border-color: #c9b458;
    }
    .incorrect {
      background-color: #787c7e;
      color: white;
      border-color: #787c7e;
    }
    .answered {
      background-color: #6aaa64;
      width: 500px;
      color: white;
      border-radius: 15px;
      padding: 15px;
      margin: 10px 0;
      font-size: 20px;
    }
    .unanswered {
      background-color: #787c7e;
      width: 500px;
      color: white;
      border-radius: 15px;
      padding: 15px;
      margin: 10px 0;
      font-size: 20px;
    }

    #result {
      text-align: center;
      margin-top: 20px;
      font-size: 18px;
    }

    .leaderboard-entry {
      background: rgba(255, 255, 255, 0.8);
      margin: 5px auto;
      padding: 10px;
      border-radius: 10px;
      max-width: 300px;
      font-weight: bold;
      color: #333;
    }

    .leaderboard-rank {
      color: #ff6b6b;
      font-size: 16px;
    }

    @media (max-width: 768px) {
      body {
        overflow: auto;
        height: auto;
        min-height: 100vh;
      }

      .main-layout {
        flex-direction: column;
        height: auto;
        min-height: 100vh;
        padding: 10px;
      }

      .game-container {
        max-width: 100%;
        margin-bottom: 15px;
      }

      .instructions-container {
        position: static;
        order: -1;
        height: auto;
        min-width: auto;
        max-width: 100%;
        margin-bottom: 15px;
      }
    }
  </style>
</head>
<body>
  <div class="main-layout">
  <div class="game-container">
    <a href="/" class="back-button">üè† Back to Home</a>
    <h1>üéØ Wordle Game by Abheek and Akira! üéØ</h1>

    <!-- Leaderboard Section -->

    <div class="leaderboard-section" style="background: rgba(78, 205, 196, 0.1); border-radius: 15px; padding: 20px; margin-bottom: 20px;">  
      <h2 style="color: #4ecdc4; text-align: center; margin-bottom: 15px;">üèÜ Overall Top Scores üèÜ</h2>
      <div id="leaderboard" style="text-align: center;"></div>
    </div>



    <div class="player-info">
      <input type="text" id="playerName" placeholder="Enter your name" style="margin-bottom: 10px;">
      <div id="rank" style="font-size: 20px; color: #4ecdc4; font-weight: bold; margin-bottom: 15px;"></div>
      <div id="scoreDisplay" style="font-size: 20px; color: #4ecdc4; font-weight: bold; margin-bottom: 15px;"></div>
    </div>

    <div class="game-controls">
      <input type="text" id="guess" minlength="4" maxlength="6" placeholder="Enter your guess">
      <br>
      <button onclick="makeGuess()">üéÆ Guess!</button>
      <button class="reset-btn" onclick="resetGame()">üîÑ New Game</button>
      <button class="clue-btn"  onclick="showClue()"> üí° Show Clue!(100 points will be deducted)</button>
      <div id="clue" style="font-size: 18px; color: #4ecdc4; font-weight: bold; margin-top: 15px;"></div>
    </div>

    <div id="result"></div>
  </div>

  <div class="instructions-container">
      <h2>How to Play</h2>
      <ol>
        <li>Each guess attempt reduces your score by 300 points.</li>
        <li>If you guess correctly on the first attempt, your score is 300. If on the 5th attempt, it's 100. If unanswered, it's zero.</li>
        <li>Asking for a clue will reduce your score by 100 points.</li>
        <li>The overall leaderboard is the sum of your scores from all games, limited to the top 10.</li>
        <li>Your overall rank is displayed once your game starts.</li>
        <li>If anyone uses incorrect names, they cannot reduce others' scores, but you can increase scores.</li>
      </ol>
    </div>
  </div>

  <script>
    async function loadLeaderboard() {
      try {
          const playerName = document.getElementById('playerName').value;
        if (!playerName) {
          alert('Please enter your name first! üòä');
          return;
        }

        const response = await fetch('/leaderboard',  {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({playerName})
        });

        const data = await response.json();
        const leaderboard = data.leaderboard;

        let leaderboardHTML = '';
        if (leaderboard.length === 0) {
          leaderboardHTML = '<div style="color: #999; font-style: italic;">No scores yet! Be the first to play! üéÆ</div>';
        } else {
          leaderboard.forEach((entry, index) => {
            const rank = index + 1;
            const trophy = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : 'üèÜ';

            leaderboardHTML += `
              <div class="leaderboard-entry">
                <span class="leaderboard-rank">${trophy} #${rank}</span> 
                ${entry.name} - ${entry.score} points
              </div>
            `;
          });
        }

        document.getElementById('leaderboard').innerHTML = leaderboardHTML;

        const rankHTML = `üí° Your overall Rank: ${data.rank}`;

        document.getElementById('rank').innerHTML = rankHTML;


      } catch (error) {
        console.error('Error loading leaderboard:', error);
      }
    }

    async function makeGuess() {
      const guess = document.getElementById('guess').value;
      const playerName = document.getElementById('playerName').value;
      const guessInput = document.getElementById('guess');
      const playerNameInput = document.getElementById('playerName');

      if (!playerName) {
        alert('Please enter your name first! üòä');
        return;
      }
      loadLeaderboard();

      if (!guess) {
        alert('Please enter a word! üòä');
        return;
      }

      // Disable inputs once game starts
      guessInput.disabled = true;
      playerNameInput.disabled = true;

      const response = await fetch('/guess', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({guess, playerName})
      });
      const data = await response.json();
      document.getElementById('result').innerHTML = data.result.join('');
      document.getElementById('guess').value = '';

      // Re-enable guess input for next guess, but keep player name disabled
      guessInput.disabled = false;

      // Update score display
      if (data.score !== undefined) {
        document.getElementById('scoreDisplay').innerHTML = `üéØ ${playerName}'s current game score: ${data.score}`;
        // Reload leaderboard after a successful game
        loadLeaderboard();
      }
    }

    async function resetGame() {
      await fetch('/reset', {method: 'POST'});

      document.getElementById('result').innerHTML = '<p style="color: #4ecdc4; font-size: 20px;">üéâ New word selected! Good luck! üçÄ</p>';
      document.getElementById('guess').value = '';
      document.getElementById('scoreDisplay').innerHTML = '';
      document.getElementById('clue').innerHTML = '';

      // Re-enable inputs for new game
      document.getElementById('guess').disabled = false;
      document.getElementById('playerName').disabled = false;

      // Re-enable the clue button for the new game
      const clueButton = document.querySelector('.clue-btn');
      clueButton.disabled = false;
      clueButton.style.opacity = '1';
      clueButton.style.cursor = 'pointer';
    }


    async function showClue() {
      const playerName = document.getElementById('playerName').value;

      if (!playerName) {
        alert('Please enter your name first! üòä');
        return;
      }

      const response = await fetch('/clue', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({playerName})
      });

      const data = await response.json();
      const clueHTML = `üí° Clue: ${data.clue}`;
      document.getElementById('clue').innerHTML = clueHTML;

      // Disable the clue button after it's used
      const clueButton = document.querySelector('.clue-btn');
      clueButton.disabled = true;
      clueButton.style.opacity = '0.5';
      clueButton.style.cursor = 'not-allowed';

      // Update score display
      if (data.score !== undefined) {
        document.getElementById('scoreDisplay').innerHTML = `üéØ ${playerName}'s Score: ${data.score}`;
      }
    }

    // Allow Enter key to submit guess
    document.getElementById('guess').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        makeGuess();
      }
    });

    // Load leaderboard when page loads
    // window.addEventListener('load', loadLeaderboard);
  </script>
</body>
</html>